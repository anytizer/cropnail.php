<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="yes" name="mobile-web-app-capable">
    <meta content="yes" name="apple-mobile-web-app-capable">

    <link href="resources/bootstrap.min.css" rel="stylesheet">
    <link href="resources/style.css" rel="stylesheet">

    <title>
        Source file | ApiGen It-self
    </title>
</head>

<body>
<div id="navigation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <nav class="navbar">
                    <ul class="nav navbar-nav">
                        <li>
                            <a href="index.html">
                                ApiGen It-self
                            </a>
                        </li>

                        <li>
                            <a href="classes.html">Classes</a>
                        </li>


                    </ul>

                    <form class="pull-right" id="search">
                        <input autofocus class="form-control text" name="q"
                               placeholder="Search class, function or namespace" type="text">
                    </form>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div id="source">
                <pre class="numbers"><code><span class="l" id="1"><a href="#1">  1: </a></span><span class="l" id="2"><a
                        href="#2">  2: </a></span><span class="l" id="3"><a href="#3">  3: </a></span><span class="l"
                                                                                                            id="4"><a
                        href="#4">  4: </a></span></span><span class="l" id="5"><a href="#5">  5: </a></span></span>
                    <span class="l" id="6"><a href="#6">  6: </a></span></span><span class="l" id="7"><a
                            href="#7">  7: </a></span></span><span class="l" id="8"><a href="#8">  8: </a></span></span>
                    <span class="l" id="9"><a href="#9">  9: </a></span></span><span class="l" id="10"><a href="#10"> 10: </a></span></span>
                    <span class="l" id="11"><a href="#11"> 11: </a></span></span><span class="l" id="12"><a href="#12"> 12: </a></span><span
                            class="l" id="13"><a href="#13"> 13: </a></span><span class="l" id="14"><a
                            href="#14"> 14: </a></span><span class="l" id="15"><a href="#15"> 15: </a></span></span>
                    <span class="l" id="16"><a href="#16"> 16: </a></span></span><span class="l" id="17"><a href="#17"> 17: </a></span></span>
                    <span class="l" id="18"><a href="#18"> 18: </a></span></span><span class="l" id="19"><a href="#19"> 19: </a></span></span>
                    <span class="l" id="20"><a href="#20"> 20: </a></span></span><span class="l" id="21"><a href="#21"> 21: </a></span><span
                            class="l" id="22"><a href="#22"> 22: </a></span><span class="l" id="23"><a
                            href="#23"> 23: </a></span><span class="l" id="24"><a href="#24"> 24: </a></span><span
                            class="l" id="25"><a href="#25"> 25: </a></span><span class="l" id="26"><a
                            href="#26"> 26: </a></span><span class="l" id="27"><a href="#27"> 27: </a></span><span
                            class="l" id="28"><a href="#28"> 28: </a></span><span class="l" id="29"><a
                            href="#29"> 29: </a></span><span class="l" id="30"><a href="#30"> 30: </a></span><span
                            class="l" id="31"><a href="#31"> 31: </a></span><span class="l" id="32"><a
                            href="#32"> 32: </a></span></span><span class="l" id="33"><a
                            href="#33"> 33: </a></span></span><span class="l" id="34"><a
                            href="#34"> 34: </a></span><span class="l" id="35"><a href="#35"> 35: </a></span><span
                            class="l" id="36"><a href="#36"> 36: </a></span><span class="l" id="37"><a
                            href="#37"> 37: </a></span><span class="l" id="38"><a href="#38"> 38: </a></span></span>
                    <span class="l" id="39"><a href="#39"> 39: </a></span></span><span class="l" id="40"><a href="#40"> 40: </a></span><span
                            class="l" id="41"><a href="#41"> 41: </a></span><span class="l" id="42"><a
                            href="#42"> 42: </a></span></span><span class="l" id="43"><a
                            href="#43"> 43: </a></span></span><span class="l" id="44"><a
                            href="#44"> 44: </a></span></span><span class="l" id="45"><a
                            href="#45"> 45: </a></span><span class="l" id="46"><a href="#46"> 46: </a></span><span
                            class="l" id="47"><a href="#47"> 47: </a></span><span class="l" id="48"><a
                            href="#48"> 48: </a></span><span class="l" id="49"><a href="#49"> 49: </a></span><span
                            class="l" id="50"><a href="#50"> 50: </a></span></span><span class="l" id="51"><a
                            href="#51"> 51: </a></span></span><span class="l" id="52"><a
                            href="#52"> 52: </a></span><span class="l" id="53"><a href="#53"> 53: </a></span><span
                            class="l" id="54"><a href="#54"> 54: </a></span><span class="l" id="55"><a
                            href="#55"> 55: </a></span><span class="l" id="56"><a href="#56"> 56: </a></span><span
                            class="l" id="57"><a href="#57"> 57: </a></span><span class="l" id="58"><a
                            href="#58"> 58: </a></span><span class="l" id="59"><a href="#59"> 59: </a></span><span
                            class="l" id="60"><a href="#60"> 60: </a></span></span><span class="l" id="61"><a
                            href="#61"> 61: </a></span></span><span class="l" id="62"><a
                            href="#62"> 62: </a></span><span class="l" id="63"><a href="#63"> 63: </a></span><span
                            class="l" id="64"><a href="#64"> 64: </a></span><span class="l" id="65"><a
                            href="#65"> 65: </a></span></span><span class="l" id="66"><a
                            href="#66"> 66: </a></span></span><span class="l" id="67"><a
                            href="#67"> 67: </a></span></span><span class="l" id="68"><a
                            href="#68"> 68: </a></span><span class="l" id="69"><a href="#69"> 69: </a></span><span
                            class="l" id="70"><a href="#70"> 70: </a></span><span class="l" id="71"><a
                            href="#71"> 71: </a></span></span><span class="l" id="72"><a
                            href="#72"> 72: </a></span></span><span class="l" id="73"><a
                            href="#73"> 73: </a></span></span><span class="l" id="74"><a
                            href="#74"> 74: </a></span></span><span class="l" id="75"><a
                            href="#75"> 75: </a></span></span><span class="l" id="76"><a
                            href="#76"> 76: </a></span></span><span class="l" id="77"><a
                            href="#77"> 77: </a></span></span><span class="l" id="78"><a
                            href="#78"> 78: </a></span><span class="l" id="79"><a href="#79"> 79: </a></span><span
                            class="l" id="80"><a href="#80"> 80: </a></span><span class="l" id="81"><a
                            href="#81"> 81: </a></span><span class="l" id="82"><a href="#82"> 82: </a></span><span
                            class="l" id="83"><a href="#83"> 83: </a></span><span class="l" id="84"><a
                            href="#84"> 84: </a></span><span class="l" id="85"><a href="#85"> 85: </a></span><span
                            class="l" id="86"><a href="#86"> 86: </a></span><span class="l" id="87"><a
                            href="#87"> 87: </a></span></span><span class="l" id="88"><a
                            href="#88"> 88: </a></span></span><span class="l" id="89"><a
                            href="#89"> 89: </a></span></span><span class="l" id="90"><a
                            href="#90"> 90: </a></span></span><span class="l" id="91"><a
                            href="#91"> 91: </a></span></span><span class="l" id="92"><a
                            href="#92"> 92: </a></span><span class="l" id="93"><a href="#93"> 93: </a></span><span
                            class="l" id="94"><a href="#94"> 94: </a></span><span class="l" id="95"><a
                            href="#95"> 95: </a></span><span class="l" id="96"><a href="#96"> 96: </a></span><span
                            class="l" id="97"><a href="#97"> 97: </a></span><span class="l" id="98"><a
                            href="#98"> 98: </a></span></span><span class="l" id="99"><a
                            href="#99"> 99: </a></span></span><span class="l" id="100"><a
                            href="#100">100: </a></span><span class="l" id="101"><a href="#101">101: </a></span><span
                            class="l" id="102"><a href="#102">102: </a></span><span class="l" id="103"><a href="#103">103: </a></span><span
                            class="l" id="104"><a href="#104">104: </a></span></span><span class="l" id="105"><a
                            href="#105">105: </a></span></span><span class="l" id="106"><a
                            href="#106">106: </a></span></span><span class="l" id="107"><a
                            href="#107">107: </a></span></span><span class="l" id="108"><a
                            href="#108">108: </a></span><span class="l" id="109"><a href="#109">109: </a></span><span
                            class="l" id="110"><a href="#110">110: </a></span><span class="l" id="111"><a href="#111">111: </a></span><span
                            class="l" id="112"><a href="#112">112: </a></span><span class="l" id="113"><a href="#113">113: </a></span><span
                            class="l" id="114"><a href="#114">114: </a></span></span><span class="l" id="115"><a
                            href="#115">115: </a></span></span><span class="l" id="116"><a
                            href="#116">116: </a></span></span><span class="l" id="117"><a
                            href="#117">117: </a></span></span><span class="l" id="118"><a
                            href="#118">118: </a></span></span><span class="l" id="119"><a
                            href="#119">119: </a></span></span><span class="l" id="120"><a
                            href="#120">120: </a></span></span><span class="l" id="121"><a
                            href="#121">121: </a></span></span><span class="l" id="122"><a
                            href="#122">122: </a></span></span><span class="l" id="123"><a
                            href="#123">123: </a></span><span class="l" id="124"><a href="#124">124: </a></span><span
                            class="l" id="125"><a href="#125">125: </a></span><span class="l" id="126"><a href="#126">126: </a></span></span>
                    <span class="l" id="127"><a href="#127">127: </a></span></span><span class="l" id="128"><a
                            href="#128">128: </a></span><span class="l" id="129"><a href="#129">129: </a></span><span
                            class="l" id="130"><a href="#130">130: </a></span><span class="l" id="131"><a href="#131">131: </a></span><span
                            class="l" id="132"><a href="#132">132: </a></span><span class="l" id="133"><a href="#133">133: </a></span></span>
                    <span class="l" id="134"><a href="#134">134: </a></span></span><span class="l" id="135"><a
                            href="#135">135: </a></span></span><span class="l" id="136"><a
                            href="#136">136: </a></span><span class="l" id="137"><a href="#137">137: </a></span><span
                            class="l" id="138"><a href="#138">138: </a></span><span class="l" id="139"><a href="#139">139: </a></span><span
                            class="l" id="140"><a href="#140">140: </a></span><span class="l" id="141"><a href="#141">141: </a></span></span>
                    <span class="l" id="142"><a href="#142">142: </a></span></span><span class="l" id="143"><a
                            href="#143">143: </a></span><span class="l" id="144"><a href="#144">144: </a></span><span
                            class="l" id="145"><a href="#145">145: </a></span><span class="l" id="146"><a href="#146">146: </a></span><span
                            class="l" id="147"><a href="#147">147: </a></span><span class="l" id="148"><a href="#148">148: </a></span><span
                            class="l" id="149"><a href="#149">149: </a></span><span class="l" id="150"><a href="#150">150: </a></span><span
                            class="l" id="151"><a href="#151">151: </a></span><span class="l" id="152"><a href="#152">152: </a></span><span
                            class="l" id="153"><a href="#153">153: </a></span></span><span class="l" id="154"><a
                            href="#154">154: </a></span></span><span class="l" id="155"><a
                            href="#155">155: </a></span><span class="l" id="156"><a href="#156">156: </a></span><span
                            class="l" id="157"><a href="#157">157: </a></span><span class="l" id="158"><a href="#158">158: </a></span><span
                            class="l" id="159"><a href="#159">159: </a></span></span><span class="l" id="160"><a
                            href="#160">160: </a></span></span><span class="l" id="161"><a
                            href="#161">161: </a></span><span class="l" id="162"><a href="#162">162: </a></span><span
                            class="l" id="163"><a href="#163">163: </a></span><span class="l" id="164"><a href="#164">164: </a></span><span
                            class="l" id="165"><a href="#165">165: </a></span><span class="l" id="166"><a href="#166">166: </a></span><span
                            class="l" id="167"><a href="#167">167: </a></span><span class="l" id="168"><a href="#168">168: </a></span><span
                            class="l" id="169"><a href="#169">169: </a></span><span class="l" id="170"><a href="#170">170: </a></span><span
                            class="l" id="171"><a href="#171">171: </a></span><span class="l" id="172"><a href="#172">172: </a></span><span
                            class="l" id="173"><a href="#173">173: </a></span><span class="l" id="174"><a href="#174">174: </a></span><span
                            class="l" id="175"><a href="#175">175: </a></span><span class="l" id="176"><a href="#176">176: </a></span><span
                            class="l" id="177"><a href="#177">177: </a></span><span class="l" id="178"><a href="#178">178: </a></span><span
                            class="l" id="179"><a href="#179">179: </a></span><span class="l" id="180"><a href="#180">180: </a></span><span
                            class="l" id="181"><a href="#181">181: </a></span><span class="l" id="182"><a href="#182">182: </a></span><span
                            class="l" id="183"><a href="#183">183: </a></span><span class="l" id="184"><a href="#184">184: </a></span><span
                            class="l" id="185"><a href="#185">185: </a></span><span class="l" id="186"><a href="#186">186: </a></span><span
                            class="l" id="187"><a href="#187">187: </a></span><span class="l" id="188"><a href="#188">188: </a></span><span
                            class="l" id="189"><a href="#189">189: </a></span><span class="l" id="190"><a href="#190">190: </a></span><span
                            class="l" id="191"><a href="#191">191: </a></span><span class="l" id="192"><a href="#192">192: </a></span><span
                            class="l" id="193"><a href="#193">193: </a></span><span class="l" id="194"><a href="#194">194: </a></span><span
                            class="l" id="195"><a href="#195">195: </a></span><span class="l" id="196"><a href="#196">196: </a></span><span
                            class="l" id="197"><a href="#197">197: </a></span><span class="l" id="198"><a href="#198">198: </a></span><span
                            class="l" id="199"><a href="#199">199: </a></span><span class="l" id="200"><a href="#200">200: </a></span><span
                            class="l" id="201"><a href="#201">201: </a></span><span class="l" id="202"><a href="#202">202: </a></span><span
                            class="l" id="203"><a href="#203">203: </a></span><span class="l" id="204"><a href="#204">204: </a></span></span>
                    <span class="l" id="205"><a href="#205">205: </a></span></span><span class="l" id="206"><a
                            href="#206">206: </a></span></span><span class="l" id="207"><a
                            href="#207">207: </a></span><span class="l" id="208"><a href="#208">208: </a></span><span
                            class="l" id="209"><a href="#209">209: </a></span><span class="l" id="210"><a href="#210">210: </a></span><span
                            class="l" id="211"><a href="#211">211: </a></span><span class="l" id="212"><a href="#212">212: </a></span><span
                            class="l" id="213"><a href="#213">213: </a></span><span class="l" id="214"><a href="#214">214: </a></span><span
                            class="l" id="215"><a href="#215">215: </a></span></span><span class="l" id="216"><a
                            href="#216">216: </a></span></span><span class="l" id="217"><a
                            href="#217">217: </a></span></span><span class="l" id="218"><a
                            href="#218">218: </a></span><span class="l" id="219"><a href="#219">219: </a></span><span
                            class="l" id="220"><a href="#220">220: </a></span><span class="l" id="221"><a href="#221">221: </a></span></span>
                    <span class="l" id="222"><a href="#222">222: </a></span></span><span class="l" id="223"><a
                            href="#223">223: </a></span><span class="l" id="224"><a href="#224">224: </a></span><span
                            class="l" id="225"><a href="#225">225: </a></span><span class="l" id="226"><a href="#226">226: </a></span><span
                            class="l" id="227"><a href="#227">227: </a></span><span class="l" id="228"><a href="#228">228: </a></span></span>
                    <span class="l" id="229"><a href="#229">229: </a></span></span><span class="l" id="230"><a
                            href="#230">230: </a></span><span class="l" id="231"><a href="#231">231: </a></span><span
                            class="l" id="232"><a href="#232">232: </a></span><span class="l" id="233"><a href="#233">233: </a></span><span
                            class="l" id="234"><a href="#234">234: </a></span><span class="l" id="235"><a href="#235">235: </a></span><span
                            class="l" id="236"><a href="#236">236: </a></span><span class="l" id="237"><a href="#237">237: </a></span><span
                            class="l" id="238"><a href="#238">238: </a></span><span class="l" id="239"><a href="#239">239: </a></span><span
                            class="l" id="240"><a href="#240">240: </a></span><span class="l" id="241"><a href="#241">241: </a></span><span
                            class="l" id="242"><a href="#242">242: </a></span><span class="l" id="243"><a href="#243">243: </a></span><span
                            class="l" id="244"><a href="#244">244: </a></span><span class="l" id="245"><a href="#245">245: </a></span><span
                            class="l" id="246"><a href="#246">246: </a></span></span><span class="l" id="247"><a
                            href="#247">247: </a></span></span><span class="l" id="248"><a
                            href="#248">248: </a></span></span><span class="l" id="249"><a
                            href="#249">249: </a></span></span><span class="l" id="250"><a
                            href="#250">250: </a></span><span class="l" id="251"><a href="#251">251: </a></span><span
                            class="l" id="252"><a href="#252">252: </a></span><span class="l" id="253"><a href="#253">253: </a></span><span
                            class="l" id="254"><a href="#254">254: </a></span><span class="l" id="255"><a href="#255">255: </a></span><span
                            class="l" id="256"><a href="#256">256: </a></span></span><span class="l" id="257"><a
                            href="#257">257: </a></span></span><span class="l" id="258"><a
                            href="#258">258: </a></span><span class="l" id="259"><a href="#259">259: </a></span><span
                            class="l" id="260"><a href="#260">260: </a></span><span class="l" id="261"><a href="#261">261: </a></span><span
                            class="l" id="262"><a href="#262">262: </a></span><span class="l" id="263"><a href="#263">263: </a></span><span
                            class="l" id="264"><a href="#264">264: </a></span><span class="l" id="265"><a href="#265">265: </a></span><span
                            class="l" id="266"><a href="#266">266: </a></span><span class="l" id="267"><a href="#267">267: </a></span><span
                            class="l" id="268"><a href="#268">268: </a></span><span class="l" id="269"><a href="#269">269: </a></span><span
                            class="l" id="270"><a href="#270">270: </a></span><span class="l" id="271"><a href="#271">271: </a></span><span
                            class="l" id="272"><a href="#272">272: </a></span><span class="l" id="273"><a href="#273">273: </a></span><span
                            class="l" id="274"><a href="#274">274: </a></span><span class="l" id="275"><a href="#275">275: </a></span><span
                            class="l" id="276"><a href="#276">276: </a></span><span class="l" id="277"><a href="#277">277: </a></span><span
                            class="l" id="278"><a href="#278">278: </a></span><span class="l" id="279"><a href="#279">279: </a></span><span
                            class="l" id="280"><a href="#280">280: </a></span><span class="l" id="281"><a href="#281">281: </a></span><span
                            class="l" id="282"><a href="#282">282: </a></span><span class="l" id="283"><a href="#283">283: </a></span><span
                            class="l" id="284"><a href="#284">284: </a></span><span class="l" id="285"><a href="#285">285: </a></span><span
                            class="l" id="286"><a href="#286">286: </a></span><span class="l" id="287"><a href="#287">287: </a></span><span
                            class="l" id="288"><a href="#288">288: </a></span><span class="l" id="289"><a href="#289">289: </a></span></span>
                    <span class="l" id="290"><a href="#290">290: </a></span></span><span class="l" id="291"><a
                            href="#291">291: </a></span></span><span class="l" id="292"><a
                            href="#292">292: </a></span></span><span class="l" id="293"><a
                            href="#293">293: </a></span></span><span class="l" id="294"><a
                            href="#294">294: </a></span></span><span class="l" id="295"><a
                            href="#295">295: </a></span></span><span class="l" id="296"><a
                            href="#296">296: </a></span></span><span class="l" id="297"><a
                            href="#297">297: </a></span><span class="l" id="298"><a href="#298">298: </a></span><span
                            class="l" id="299"><a href="#299">299: </a></span><span class="l" id="300"><a href="#300">300: </a></span><span
                            class="l" id="301"><a href="#301">301: </a></span><span class="l" id="302"><a href="#302">302: </a></span><span
                            class="l" id="303"><a href="#303">303: </a></span></span><span class="l" id="304"><a
                            href="#304">304: </a></span></span><span class="l" id="305"><a
                            href="#305">305: </a></span></span><span class="l" id="306"><a
                            href="#306">306: </a></span></span><span class="l" id="307"><a
                            href="#307">307: </a></span></span><span class="l" id="308"><a
                            href="#308">308: </a></span></span><span class="l" id="309"><a
                            href="#309">309: </a></span></span><span class="l" id="310"><a
                            href="#310">310: </a></span><span class="l" id="311"><a href="#311">311: </a></span><span
                            class="l" id="312"><a href="#312">312: </a></span><span class="l" id="313"><a href="#313">313: </a></span><span
                            class="l" id="314"><a href="#314">314: </a></span><span class="l" id="315"><a href="#315">315: </a></span><span
                            class="l" id="316"><a href="#316">316: </a></span><span class="l" id="317"><a href="#317">317: </a></span></span>
                    <span class="l" id="318"><a href="#318">318: </a></span></span><span class="l" id="319"><a
                            href="#319">319: </a></span></span><span class="l" id="320"><a
                            href="#320">320: </a></span></span><span class="l" id="321"><a
                            href="#321">321: </a></span></span><span class="l" id="322"><a
                            href="#322">322: </a></span></span><span class="l" id="323"><a
                            href="#323">323: </a></span><span class="l" id="324"><a href="#324">324: </a></span><span
                            class="l" id="325"><a href="#325">325: </a></span><span class="l" id="326"><a href="#326">326: </a></span><span
                            class="l" id="327"><a href="#327">327: </a></span><span class="l" id="328"><a href="#328">328: </a></span><span
                            class="l" id="329"><a href="#329">329: </a></span><span class="l" id="330"><a href="#330">330: </a></span></span>
                    <span class="l" id="331"><a href="#331">331: </a></span></span><span class="l" id="332"><a
                            href="#332">332: </a></span></span><span class="l" id="333"><a
                            href="#333">333: </a></span><span class="l" id="334"><a href="#334">334: </a></span><span
                            class="l" id="335"><a href="#335">335: </a></span><span class="l" id="336"><a href="#336">336: </a></span><span
                            class="l" id="337"><a href="#337">337: </a></span><span class="l" id="338"><a href="#338">338: </a></span><span
                            class="l" id="339"><a href="#339">339: </a></span></span><span class="l" id="340"><a
                            href="#340">340: </a></span></span><span class="l" id="341"><a
                            href="#341">341: </a></span></span><span class="l" id="342"><a
                            href="#342">342: </a></span></span><span class="l" id="343"><a
                            href="#343">343: </a></span></span><span class="l" id="344"><a
                            href="#344">344: </a></span><span class="l" id="345"><a href="#345">345: </a></span><span
                            class="l" id="346"><a href="#346">346: </a></span><span class="l" id="347"><a href="#347">347: </a></span><span
                            class="l" id="348"><a href="#348">348: </a></span><span class="l" id="349"><a href="#349">349: </a></span><span
                            class="l" id="350"><a href="#350">350: </a></span></code></pre>
                <pre class="code"><code><span class="l" id="line-1"><span class="xlang">&lt;?php</span>
</span><span class="l" id="line-2"><span class="php-keyword1">namespace</span> images;
</span><span class="l" id="line-3">
</span><span class="l" id="line-4"><span class="php-comment">/**
</span></span><span class="l" id="line-5"><span class="php-comment"> * Crops an image into any size - keeping the aspect ratio.
</span></span><span class="l" id="line-6"><span class="php-comment"> * Rather it will crop the best largest size possible within the image to maintain the ratio.
</span></span><span class="l" id="line-7"><span class="php-comment"> * So, it is practically possible to create thumbnails of any size from the original image of any size.
</span></span><span class="l" id="line-8"><span class="php-comment"> *
</span></span><span class="l" id="line-9"><span class="php-comment"> * @example $cropnail = new cropnail(100, 200);
</span></span><span class="l" id="line-10"><span class="php-comment"> * @example $cropnail-&gt;resize($original_image_filename, $cropnail_image_filename);
</span></span><span class="l" id="line-11"><span class="php-comment"> * @see http://www.sitepoint.com/forums/showthread.php?868379-Dealing-With-Different-User-Image-Sizes&amp;highlight=multipe+image+sizes
</span></span><span class="l" id="line-12"><span class="php-comment"> */</span>
</span><span class="l" id="line-13"><span class="php-keyword1">class</span> cropnail
</span><span class="l" id="line-14">{
</span><span class="l" id="line-15">    <span class="php-comment">/**
</span></span><span class="l" id="line-16"><span class="php-comment">     * Possible positions for cropping.
</span></span><span class="l" id="line-17"><span class="php-comment">     * Can once only one from horizontally or vertically only.
</span></span><span class="l" id="line-18"><span class="php-comment">     * Both of them do not apply.
</span></span><span class="l" id="line-19"><span class="php-comment">     * Match the values with that of the database as well.
</span></span><span class="l" id="line-20"><span class="php-comment">     * Do not set to zero (default, and unused).
</span></span><span class="l" id="line-21"><span class="php-comment">     */</span>
</span><span class="l" id="line-22">    <span class="php-keyword1">const</span> CROPNAIL_VERTICAL_LEFT = <span
                        class="php-num">1</span>;
</span><span class="l" id="line-23">    <span class="php-keyword1">const</span> CROPNAIL_VERTICAL_CENTER = <span
                        class="php-num">2</span>;
</span><span class="l" id="line-24">    <span class="php-keyword1">const</span> CROPNAIL_VERTICAL_RIGHT = <span
                        class="php-num">3</span>;
</span><span class="l" id="line-25">    <span class="php-keyword1">const</span> CROPNAIL_HORIZONTAL_TOP = <span
                        class="php-num">4</span>;
</span><span class="l" id="line-26">    <span class="php-keyword1">const</span> CROPNAIL_HORIZONTAL_CENTER = <span
                        class="php-num">5</span>;
</span><span class="l" id="line-27">    <span class="php-keyword1">const</span> CROPNAIL_HORIZONTAL_BOTTOM = <span
                        class="php-num">6</span>;
</span><span class="l" id="line-28">    <span class="php-keyword1">const</span> CROPNAIL_BOTTOM_RIGHT = <span
                        class="php-num">7</span>;
</span><span class="l" id="line-29">    <span class="php-keyword1">const</span> CROPNAIL_BOTTOM_LEFT = <span
                        class="php-num">8</span>;
</span><span class="l" id="line-30">    <span class="php-keyword1">const</span> CROPNAIL_TOP_RIGHT = <span
                        class="php-num">9</span>;
</span><span class="l" id="line-31">    <span class="php-keyword1">const</span> CROPNAIL_TOP_LEFT = <span
                        class="php-num">10</span>;
</span><span class="l" id="line-32">    <span class="php-comment">/**
</span></span><span class="l" id="line-33"><span class="php-comment">     * Resize the output image to these dimensions
</span></span><span class="l" id="line-34"><span class="php-comment">     */</span>
</span><span class="l" id="line-35">    <span class="php-keyword1">private</span> <span
                        class="php-var">$resize_width</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-36">    <span class="php-keyword1">private</span> <span
                        class="php-var">$resize_height</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-37">    <span class="php-keyword1">private</span> <span
                        class="php-var">$transparent</span> = <span class="php-keyword1">false</span>;
</span><span class="l" id="line-38">    <span class="php-comment">/**
</span></span><span class="l" id="line-39"><span class="php-comment">     * @var integer Image output quality in Percentage
</span></span><span class="l" id="line-40"><span class="php-comment">     */</span>
</span><span class="l" id="line-41">    <span class="php-keyword1">private</span> <span class="php-var">$quality</span> = <span
                        class="php-num">75</span>;
</span><span class="l" id="line-42">    <span class="php-comment">/**
</span></span><span class="l" id="line-43"><span class="php-comment">     * A dynamically/programatically chosen cropnail position from one of the above constants.
</span></span><span class="l" id="line-44"><span class="php-comment">     * Or, optional use the hard coded x/y positions without mathematical calculations.
</span></span><span class="l" id="line-45"><span class="php-comment">     */</span>
</span><span class="l" id="line-46">    <span class="php-keyword1">private</span> <span
                        class="php-var">$position_id</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-47">    <span class="php-keyword1">private</span> <span
                        class="php-var">$cropnail_x</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-48">    <span class="php-keyword1">private</span> <span
                        class="php-var">$cropnail_y</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-49">
</span><span class="l" id="line-50">    <span class="php-comment">/**
</span></span><span class="l" id="line-51"><span class="php-comment">     * Record cropnail points for post-operation usage
</span></span><span class="l" id="line-52"><span class="php-comment">     */</span>
</span><span class="l" id="line-53">    <span class="php-keyword1">private</span> <span
                        class="php-var">$source_x1</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-54">    <span class="php-keyword1">private</span> <span
                        class="php-var">$source_x2</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-55">    <span class="php-keyword1">private</span> <span
                        class="php-var">$source_y1</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-56">    <span class="php-keyword1">private</span> <span
                        class="php-var">$source_y2</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-57">
</span><span class="l" id="line-58">    <span class="php-keyword1">private</span> <span
                        class="php-var">$mime</span> = <span class="php-quote">&quot;image/png&quot;</span>; <span
                        class="php-comment"># gif, jpeg, png</span>
</span><span class="l" id="line-59">
</span><span class="l" id="line-60">    <span class="php-comment">/**
</span></span><span class="l" id="line-61"><span class="php-comment">     * List of processing activities
</span></span><span class="l" id="line-62"><span class="php-comment">     */</span>
</span><span class="l" id="line-63">    <span class="php-keyword1">private</span> <span class="php-var">$debug</span> = <span
                        class="php-keyword1">array</span>();
</span><span class="l" id="line-64">
</span><span class="l" id="line-65">    <span class="php-comment">/**
</span></span><span class="l" id="line-66"><span class="php-comment">     * Continue to other images during mass processing
</span></span><span class="l" id="line-67"><span class="php-comment">     * even if an error was found at some point
</span></span><span class="l" id="line-68"><span class="php-comment">     */</span>
</span><span class="l" id="line-69">    <span class="php-keyword1">private</span> <span
                        class="php-var">$allow_continue</span>;
</span><span class="l" id="line-70">
</span><span class="l" id="line-71">    <span class="php-comment">/**
</span></span><span class="l" id="line-72"><span class="php-comment">     * Set the target dimension at the time of initialization
</span></span><span class="l" id="line-73"><span class="php-comment">     *
</span></span><span class="l" id="line-74"><span class="php-comment">     * cropnail constructor.
</span></span><span class="l" id="line-75"><span class="php-comment">     * @param int $width
</span></span><span class="l" id="line-76"><span class="php-comment">     * @param int $height
</span></span><span class="l" id="line-77"><span class="php-comment">     * @param int $quality
</span></span><span class="l" id="line-78"><span class="php-comment">     */</span>
</span><span class="l" id="line-79">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> __construct(<span class="php-var">$width</span> = <span
                        class="php-num">0</span>, <span class="php-var">$height</span> = <span class="php-num">0</span>, <span
                        class="php-var">$quality</span> = <span class="php-num">75</span>)
</span><span class="l" id="line-80">    {
</span><span class="l" id="line-81">        <span class="php-var">$this</span>-&gt;resizeTo(<span
                        class="php-var">$width</span>, <span class="php-var">$height</span>);
</span><span class="l" id="line-82">        <span class="php-var">$this</span>-&gt;qualityTo(<span class="php-var">$quality</span>);
</span><span class="l" id="line-83">
</span><span class="l" id="line-84">        <span class="php-var">$this</span>-&gt;debug = <span class="php-keyword1">array</span>();
</span><span class="l" id="line-85">    }
</span><span class="l" id="line-86">
</span><span class="l" id="line-87">    <span class="php-comment">/**
</span></span><span class="l" id="line-88"><span class="php-comment">     * Resize to
</span></span><span class="l" id="line-89"><span class="php-comment">     *
</span></span><span class="l" id="line-90"><span class="php-comment">     * @param int $width
</span></span><span class="l" id="line-91"><span class="php-comment">     * @param int $height
</span></span><span class="l" id="line-92"><span class="php-comment">     */</span>
</span><span class="l" id="line-93">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> resizeTo(<span class="php-var">$width</span> = <span
                        class="php-num">0</span>, <span class="php-var">$height</span> = <span class="php-num">0</span>)
</span><span class="l" id="line-94">    {
</span><span class="l" id="line-95">        <span class="php-var">$this</span>-&gt;resize_width = <span
                        class="php-keyword2">abs</span>((int)<span class="php-var">$width</span>);
</span><span class="l" id="line-96">        <span class="php-var">$this</span>-&gt;resize_height = <span
                        class="php-keyword2">abs</span>((int)<span class="php-var">$height</span>);
</span><span class="l" id="line-97">
</span><span class="l" id="line-98">        <span class="php-comment">/**
</span></span><span class="l" id="line-99"><span class="php-comment">         * Are the target dimensions ok?
</span></span><span class="l" id="line-100"><span class="php-comment">         */</span>
</span><span class="l" id="line-101">        <span class="php-var">$this</span>-&gt;allow_continue = <span
                        class="php-var">$this</span>-&gt;resize_width &gt;= <span
                        class="php-num">1</span> &amp;&amp; <span
                        class="php-var">$this</span>-&gt;resize_height &gt;= <span class="php-num">1</span>;
</span><span class="l" id="line-102">    }
</span><span class="l" id="line-103">
</span><span class="l" id="line-104">    <span class="php-comment">/**
</span></span><span class="l" id="line-105"><span class="php-comment">     * Set Image quality
</span></span><span class="l" id="line-106"><span class="php-comment">     *
</span></span><span class="l" id="line-107"><span class="php-comment">     * @param int $quality
</span></span><span class="l" id="line-108"><span class="php-comment">     */</span>
</span><span class="l" id="line-109">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> qualityTo(<span class="php-var">$quality</span> = <span
                        class="php-num">0</span>)
</span><span class="l" id="line-110">    {
</span><span class="l" id="line-111">        <span class="php-var">$this</span>-&gt;quality = <span
                        class="php-keyword2">abs</span>((int)<span class="php-var">$quality</span>);
</span><span class="l" id="line-112">    }
</span><span class="l" id="line-113">
</span><span class="l" id="line-114">    <span class="php-comment">/**
</span></span><span class="l" id="line-115"><span class="php-comment">     * Produce the cropnail-ed image file
</span></span><span class="l" id="line-116"><span class="php-comment">     *
</span></span><span class="l" id="line-117"><span class="php-comment">     * @param string $original_filename
</span></span><span class="l" id="line-118"><span class="php-comment">     * @param string $cropnail_filename
</span></span><span class="l" id="line-119"><span class="php-comment">     * @param int $crop_pattern
</span></span><span class="l" id="line-120"><span class="php-comment">     * @return bool
</span></span><span class="l" id="line-121"><span class="php-comment">     *    - true:  Image has been resized correctly
</span></span><span class="l" id="line-122"><span class="php-comment">     *    - false: Image has NOT been resized because of several reasons
</span></span><span class="l" id="line-123"><span class="php-comment">     */</span>
</span><span class="l" id="line-124">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> resize(<span
                        class="php-var">$original_filename</span> = <span class="php-quote">&quot;&quot;</span>, <span
                        class="php-var">$cropnail_filename</span> = <span class="php-quote">&quot;&quot;</span>, <span
                        class="php-var">$crop_pattern</span> = <span class="php-num">0</span>)
</span><span class="l" id="line-125">    {
</span><span class="l" id="line-126">        <span class="php-comment">/**
</span></span><span class="l" id="line-127"><span class="php-comment">         * Resizer needs the target dimensions
</span></span><span class="l" id="line-128"><span class="php-comment">         */</span>
</span><span class="l" id="line-129">        <span class="php-keyword1">if</span> (!(<span class="php-var">$this</span>-&gt;resize_width &amp;&amp; <span
                        class="php-var">$this</span>-&gt;resize_height)) {
</span><span class="l" id="line-130">            <span class="php-keyword1">return</span> <span class="php-keyword1">false</span>;
</span><span class="l" id="line-131">        }
</span><span class="l" id="line-132">
</span><span class="l" id="line-133">        <span class="php-comment">/**
</span></span><span class="l" id="line-134"><span class="php-comment">         * Original image file should exist
</span></span><span class="l" id="line-135"><span class="php-comment">         * Target must be defined
</span></span><span class="l" id="line-136"><span class="php-comment">         */</span>
</span><span class="l" id="line-137">        <span class="php-keyword1">if</span> (!<span
                        class="php-keyword2">is_file</span>(<span class="php-var">$original_filename</span>) || !<span
                        class="php-var">$cropnail_filename</span>) {
</span><span class="l" id="line-138">            <span class="php-keyword1">return</span> <span class="php-keyword1">false</span>;
</span><span class="l" id="line-139">        }
</span><span class="l" id="line-140">
</span><span class="l" id="line-141">        <span class="php-comment">/**
</span></span><span class="l" id="line-142"><span class="php-comment">         * Find out the source image size
</span></span><span class="l" id="line-143"><span class="php-comment">         */</span>
</span><span class="l" id="line-144">        <span class="php-var">$canvas_sizes</span> = <span class="php-keyword2">getimagesize</span>(<span
                        class="php-var">$original_filename</span>);
</span><span class="l" id="line-145">        <span class="php-keyword1">if</span> (!<span
                        class="php-var">$canvas_sizes</span>) {
</span><span class="l" id="line-146">            <span class="php-var">$this</span>-&gt;debug[] = <span
                        class="php-quote">&quot;Not an image: </span><span
                        class="php-var">{$original_filename}</span><span class="php-quote">&quot;</span>;
</span><span class="l" id="line-147">
</span><span class="l" id="line-148">            <span class="php-keyword1">return</span> <span class="php-keyword1">false</span>;
</span><span class="l" id="line-149">        }
</span><span class="l" id="line-150">        <span class="php-var">$canvas_width</span> = <span class="php-var">$canvas_sizes</span>[<span
                        class="php-num">0</span>];
</span><span class="l" id="line-151">        <span class="php-var">$canvas_height</span> = <span class="php-var">$canvas_sizes</span>[<span
                        class="php-num">1</span>];
</span><span class="l" id="line-152">
</span><span class="l" id="line-153">        <span class="php-comment">/**
</span></span><span class="l" id="line-154"><span class="php-comment">         * Maximum size of the clip proportional to the thumbnail
</span></span><span class="l" id="line-155"><span class="php-comment">         */</span>
</span><span class="l" id="line-156">        <span class="php-var">$clip_width</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-157">        <span class="php-var">$clip_height</span> = <span class="php-num">0</span>;
</span><span class="l" id="line-158">
</span><span class="l" id="line-159">        <span class="php-comment">/**
</span></span><span class="l" id="line-160"><span class="php-comment">         * From where should we crop the clip
</span></span><span class="l" id="line-161"><span class="php-comment">         */</span>
</span><span class="l" id="line-162">        <span class="php-var">$this</span>-&gt;source_x1 = <span
                        class="php-num">0</span>;
</span><span class="l" id="line-163">        <span class="php-var">$this</span>-&gt;source_y1 = <span
                        class="php-num">0</span>;
</span><span class="l" id="line-164">        <span class="php-var">$this</span>-&gt;source_x2 = <span
                        class="php-num">0</span>;
</span><span class="l" id="line-165">        <span class="php-var">$this</span>-&gt;source_y2 = <span
                        class="php-num">0</span>;
</span><span class="l" id="line-166">
</span><span class="l" id="line-167">        <span class="php-keyword1">if</span> (<span
                        class="php-var">$canvas_width</span> / <span class="php-var">$this</span>-&gt;resize_width &lt; <span
                        class="php-var">$canvas_height</span> / <span class="php-var">$this</span>-&gt;resize_height) {
</span><span class="l" id="line-168">            <span class="php-comment"># Coverting full width, and height needs to be re-calculated</span>
</span><span class="l" id="line-169">            <span class="php-var">$clip_width</span> = <span class="php-var">$canvas_width</span>;
</span><span class="l" id="line-170">            <span class="php-var">$clip_height</span> = <span
                        class="php-var">$this</span>-&gt;resize_height * <span
                        class="php-var">$canvas_width</span> / <span class="php-var">$this</span>-&gt;resize_width;
</span><span class="l" id="line-171">            <span class="php-var">$this</span>-&gt;debug[] = <span
                        class="php-quote">&quot;Section A: Converting full width, and height needs to be re-calculated&quot;</span>;
</span><span class="l" id="line-172">
</span><span class="l" id="line-173">            <span class="php-comment"># CROPNAIL_HORIZONTAL_CENTER</span>
</span><span class="l" id="line-174">            <span class="php-var">$this</span>-&gt;source_x1 = <span
                        class="php-num">0</span>;
</span><span class="l" id="line-175">            <span class="php-var">$this</span>-&gt;source_y1 = (<span
                        class="php-var">$canvas_height</span> - <span class="php-var">$clip_height</span>) / <span
                        class="php-num">2</span>;
</span><span class="l" id="line-176">
</span><span class="l" id="line-177">            <span class="php-comment"># TOP: Height Recalculation</span>
</span><span class="l" id="line-178">            <span class="php-comment">#$this-&gt;source_y1 = 70; # ($canvas_height-$clip_height)/2;</span>
</span><span class="l" id="line-179">
</span><span class="l" id="line-180">            <span class="php-comment"># case: 800x600 output from a vertically too tall image</span>
</span><span class="l" id="line-181">            <span class="php-comment"># Optionally hard coded</span>
</span><span class="l" id="line-182">            <span class="php-keyword1">if</span> (<span
                        class="php-var">$this</span>-&gt;cropnail_y) {
</span><span class="l" id="line-183">                <span class="php-var">$this</span>-&gt;source_y1 = <span
                        class="php-var">$this</span>-&gt;cropnail_y;
</span><span class="l" id="line-184">            }
</span><span class="l" id="line-185">        } <span class="php-keyword1">else</span> {
</span><span class="l" id="line-186">            <span class="php-comment"># Converting full height, and width needs to be re-calculated</span>
</span><span class="l" id="line-187">            <span class="php-var">$clip_width</span> = <span
                        class="php-var">$this</span>-&gt;resize_width * <span
                        class="php-var">$canvas_height</span> / <span class="php-var">$this</span>-&gt;resize_height;
</span><span class="l" id="line-188">            <span class="php-var">$clip_height</span> = <span class="php-var">$canvas_height</span>;
</span><span class="l" id="line-189">            <span class="php-var">$this</span>-&gt;debug[] = <span
                        class="php-quote">&quot;Section B: Converting full height, and width needs to be re-calculated&quot;</span>;
</span><span class="l" id="line-190">
</span><span class="l" id="line-191">            <span class="php-comment"># CROPNAIL_VERTICAL_CENTER</span>
</span><span class="l" id="line-192">            <span class="php-var">$this</span>-&gt;source_x1 = (<span
                        class="php-var">$canvas_width</span> - <span class="php-var">$clip_width</span>) / <span
                        class="php-num">2</span>;
</span><span class="l" id="line-193">            <span class="php-var">$this</span>-&gt;source_y1 = <span
                        class="php-num">0</span>;
</span><span class="l" id="line-194">
</span><span class="l" id="line-195">            <span class="php-comment"># Width Recalculation</span>
</span><span class="l" id="line-196">            <span class="php-comment"># Optionally hard coded</span>
</span><span class="l" id="line-197">            <span class="php-keyword1">if</span> (<span
                        class="php-var">$this</span>-&gt;cropnail_x) {
</span><span class="l" id="line-198">                <span class="php-var">$this</span>-&gt;source_x1 = <span
                        class="php-var">$this</span>-&gt;cropnail_x;
</span><span class="l" id="line-199">            }
</span><span class="l" id="line-200">        }
</span><span class="l" id="line-201">        <span class="php-var">$this</span>-&gt;source_x2 = <span class="php-var">$this</span>-&gt;source_x1 + <span
                        class="php-var">$clip_width</span>;
</span><span class="l" id="line-202">        <span class="php-var">$this</span>-&gt;source_y2 = <span class="php-var">$this</span>-&gt;source_y1 + <span
                        class="php-var">$clip_height</span>;
</span><span class="l" id="line-203">
</span><span class="l" id="line-204">        <span class="php-comment">/**
</span></span><span class="l" id="line-205"><span class="php-comment">         * Validations
</span></span><span class="l" id="line-206"><span class="php-comment">         * Convert to the nearest/highest integer value of the width and height
</span></span><span class="l" id="line-207"><span class="php-comment">         */</span>
</span><span class="l" id="line-208">        <span class="php-var">$clip_width</span> = <span
                        class="php-keyword2">ceil</span>(<span class="php-var">$clip_width</span>);
</span><span class="l" id="line-209">        <span class="php-var">$clip_height</span> = <span
                        class="php-keyword2">ceil</span>(<span class="php-var">$clip_height</span>);
</span><span class="l" id="line-210">        <span class="php-var">$this</span>-&gt;source_x1 = <span
                        class="php-keyword2">ceil</span>(<span class="php-var">$this</span>-&gt;source_x1);
</span><span class="l" id="line-211">        <span class="php-var">$this</span>-&gt;source_y1 = <span
                        class="php-keyword2">ceil</span>(<span class="php-var">$this</span>-&gt;source_y1);
</span><span class="l" id="line-212">        <span class="php-var">$this</span>-&gt;source_x2 = <span
                        class="php-keyword2">ceil</span>(<span class="php-var">$this</span>-&gt;source_x2);
</span><span class="l" id="line-213">        <span class="php-var">$this</span>-&gt;source_y2 = <span
                        class="php-keyword2">ceil</span>(<span class="php-var">$this</span>-&gt;source_y2);
</span><span class="l" id="line-214">
</span><span class="l" id="line-215">        <span class="php-comment">/**
</span></span><span class="l" id="line-216"><span class="php-comment">         * Canvas for target image
</span></span><span class="l" id="line-217"><span class="php-comment">         * Produce the croped thumbnail (actual cropnail)
</span></span><span class="l" id="line-218"><span class="php-comment">         */</span>
</span><span class="l" id="line-219">        <span class="php-var">$destination</span> = <span class="php-keyword2">imagecreatetruecolor</span>(<span
                        class="php-var">$this</span>-&gt;resize_width, <span class="php-var">$this</span>-&gt;resize_height);
</span><span class="l" id="line-220">
</span><span class="l" id="line-221">        <span class="php-comment">/**
</span></span><span class="l" id="line-222"><span class="php-comment">         * @todo Maintain transparency in destination
</span></span><span class="l" id="line-223"><span class="php-comment">         */</span>
</span><span class="l" id="line-224">        <span class="php-comment"># imagecolorallocate</span>
</span><span class="l" id="line-225">        <span class="php-comment"># $transparent_color = imagecolorallocatealpha($destination, 0, 0, 0, 127);</span>
</span><span class="l" id="line-226">        <span class="php-comment"># imagefill($destination, 0, 0, $transparent_color);</span>
</span><span class="l" id="line-227">
</span><span class="l" id="line-228">        <span class="php-comment">/**
</span></span><span class="l" id="line-229"><span class="php-comment">         * Support resizing of multiple image types
</span></span><span class="l" id="line-230"><span class="php-comment">         */</span>
</span><span class="l" id="line-231">        <span class="php-var">$source</span> = <span
                        class="php-keyword1">null</span>;
</span><span class="l" id="line-232">        <span class="php-var">$imagesize</span> = <span class="php-keyword2">getimagesize</span>(<span
                        class="php-var">$original_filename</span>);
</span><span class="l" id="line-233">        <span class="php-var">$this</span>-&gt;mime = <span class="php-var">$imagesize</span>[<span
                        class="php-quote">&quot;mime&quot;</span>];
</span><span class="l" id="line-234">        <span class="php-keyword1">switch</span> (<span class="php-keyword2">strtolower</span>(<span
                        class="php-var">$imagesize</span>[<span class="php-quote">&quot;mime&quot;</span>])) {
</span><span class="l" id="line-235">            <span class="php-keyword1">case</span> <span class="php-quote">&quot;image/gif&quot;</span>:
</span><span class="l" id="line-236">                <span class="php-var">$source</span> = <span class="php-keyword2">imagecreatefromgif</span>(<span
                        class="php-var">$original_filename</span>);
</span><span class="l" id="line-237">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-238">            <span class="php-keyword1">case</span> <span class="php-quote">&quot;image/jpeg&quot;</span>:
</span><span class="l" id="line-239">                <span class="php-var">$source</span> = <span class="php-keyword2">imagecreatefromjpeg</span>(<span
                        class="php-var">$original_filename</span>);
</span><span class="l" id="line-240">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-241">            <span class="php-keyword1">case</span> <span class="php-quote">&quot;image/png&quot;</span>:
</span><span class="l" id="line-242">                <span class="php-var">$source</span> = <span class="php-keyword2">imagecreatefrompng</span>(<span
                        class="php-var">$original_filename</span>);
</span><span class="l" id="line-243">                <span class="php-var">$this</span>-&gt;transparent = <span
                        class="php-var">$this</span>-&gt;is_transparent_png(<span
                        class="php-var">$original_filename</span>);
</span><span class="l" id="line-244">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-245">            <span class="php-keyword1">default</span>:
</span><span class="l" id="line-246">                <span class="php-comment">/**
</span></span><span class="l" id="line-247"><span class="php-comment">                 * Not an image file - there is no worth to attempt resize
</span></span><span class="l" id="line-248"><span class="php-comment">                 * We do not actually come here if we limit to png, gif and jpg images
</span></span><span class="l" id="line-249"><span class="php-comment">                 * At the moment we do not support other types of images
</span></span><span class="l" id="line-250"><span class="php-comment">                 */</span>
</span><span class="l" id="line-251">                <span class="php-var">$this</span>-&gt;debug[] = <span
                        class="php-quote">&quot;Not an image file: </span><span
                        class="php-var">{$original_filename}</span><span class="php-quote">&quot;</span>;
</span><span class="l" id="line-252">
</span><span class="l" id="line-253">                <span class="php-keyword1">return</span> <span
                        class="php-keyword1">false</span>;
</span><span class="l" id="line-254">        }
</span><span class="l" id="line-255">
</span><span class="l" id="line-256">        <span class="php-comment">/**
</span></span><span class="l" id="line-257"><span class="php-comment">         * Actually produce the cropnail image and save it to the file (in .jpg format)
</span></span><span class="l" id="line-258"><span class="php-comment">         */</span>
</span><span class="l" id="line-259">        <span class="php-keyword2">imagecopyresampled</span>(<span class="php-var">$destination</span>, <span
                        class="php-var">$source</span>, <span class="php-num">0</span>, <span class="php-num">0</span>, <span
                        class="php-var">$this</span>-&gt;source_x1, <span
                        class="php-var">$this</span>-&gt;source_y1, <span class="php-var">$this</span>-&gt;resize_width, <span
                        class="php-var">$this</span>-&gt;resize_height, <span class="php-var">$clip_width</span>, <span
                        class="php-var">$clip_height</span>);
</span><span class="l" id="line-260">        <span class="php-var">$success</span> = <span
                        class="php-keyword1">false</span>;
</span><span class="l" id="line-261">        <span class="php-keyword1">switch</span> (<span
                        class="php-var">$this</span>-&gt;mime) {
</span><span class="l" id="line-262">            <span class="php-keyword1">case</span> <span class="php-quote">&quot;image/gif&quot;</span>:
</span><span class="l" id="line-263">                <span class="php-var">$success</span> = <span class="php-keyword2">imagegif</span>(<span
                        class="php-var">$destination</span>, <span class="php-var">$cropnail_filename</span>);
</span><span class="l" id="line-264">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-265">            <span class="php-keyword1">case</span> <span class="php-quote">&quot;image/jpeg&quot;</span>:
</span><span class="l" id="line-266">                <span class="php-var">$success</span> = <span class="php-keyword2">imagejpeg</span>(<span
                        class="php-var">$destination</span>, <span class="php-var">$cropnail_filename</span>, <span
                        class="php-var">$this</span>-&gt;quality);
</span><span class="l" id="line-267">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-268">            <span class="php-keyword1">case</span> <span class="php-quote">&quot;image/png&quot;</span>:
</span><span class="l" id="line-269">                <span class="php-comment"># PNG_NO_FILTER or PNG_ALL_FILTERS</span>
</span><span class="l" id="line-270">                <span class="php-comment"># @todo Quality = 0 - 9, Convert the % value</span>
</span><span class="l" id="line-271">                <span class="php-var">$quality</span> = <span class="php-keyword2">floor</span>(<span
                        class="php-var">$this</span>-&gt;quality / <span class="php-num">10</span>);
</span><span class="l" id="line-272">                <span class="php-var">$filters</span> = <span class="php-keyword1">null</span>; <span
                        class="php-comment"># @todo</span>
</span><span class="l" id="line-273">                <span class="php-var">$success</span> = <span class="php-keyword2">imagepng</span>(<span
                        class="php-var">$destination</span>, <span class="php-var">$cropnail_filename</span>, <span
                        class="php-var">$quality</span>, <span class="php-var">$filters</span>);
</span><span class="l" id="line-274">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-275">            <span class="php-keyword1">default</span>:
</span><span class="l" id="line-276">                <span class="php-var">$this</span>-&gt;debug[] = <span
                        class="php-quote">&quot;Invalid output type&quot;</span>;
</span><span class="l" id="line-277">                <span class="php-keyword1">break</span>;
</span><span class="l" id="line-278">        }
</span><span class="l" id="line-279">
</span><span class="l" id="line-280">        <span class="php-comment"># Some debug information</span>
</span><span class="l" id="line-281">        <span class="php-var">$this</span>-&gt;debug[] = <span class="php-quote">&quot;Canvas: </span><span
                        class="php-var">{$canvas_width}</span><span class="php-quote"> x </span><span class="php-var">{$canvas_height}</span><span
                        class="php-quote">, </span><span class="php-var">{$original_filename}</span><span
                        class="php-quote">&quot;</span>;
</span><span class="l" id="line-282">        <span class="php-var">$this</span>-&gt;debug[] = <span class="php-quote">&quot;Clip: </span><span
                        class="php-var">{$clip_width}</span><span class="php-quote"> x </span><span class="php-var">{$clip_height}</span><span
                        class="php-quote">&quot;</span>;
</span><span class="l" id="line-283">        <span class="php-var">$this</span>-&gt;debug[] = <span class="php-quote">&quot;Resize To: </span><span
                        class="php-var">{$this-&gt;resize_width}</span><span class="php-quote"> x </span><span
                        class="php-var">{$this-&gt;resize_height}</span><span class="php-quote">&quot;</span>;
</span><span class="l" id="line-284">        <span class="php-var">$this</span>-&gt;debug[] = <span class="php-quote">&quot;Source (x1,y1), (x2,y2): (</span><span
                        class="php-var">{$this-&gt;source_x1}</span><span class="php-quote">,</span><span
                        class="php-var">{$this-&gt;source_y1}</span><span class="php-quote">), (</span><span
                        class="php-var">{$this-&gt;source_x2}</span><span class="php-quote">,</span><span
                        class="php-var">{$this-&gt;source_y2}</span><span class="php-quote">)&quot;</span>;
</span><span class="l" id="line-285">
</span><span class="l" id="line-286">        <span class="php-keyword1">return</span> <span
                        class="php-var">$success</span>;
</span><span class="l" id="line-287">    }
</span><span class="l" id="line-288">
</span><span class="l" id="line-289">    <span class="php-comment">/**
</span></span><span class="l" id="line-290"><span class="php-comment">     * Detect if a PNG Image is transparent
</span></span><span class="l" id="line-291"><span class="php-comment">     * @see http://stackoverflow.com/questions/2057923/how-to-check-a-png-for-grayscale-alpha-color-type
</span></span><span class="l" id="line-292"><span class="php-comment">     * @see http://www.codingforums.com/php/257111-checking-png-files-transparency.html
</span></span><span class="l" id="line-293"><span class="php-comment">     * @see http://perplexed.co.uk/1814_png_optimization_with_gd_library.htm
</span></span><span class="l" id="line-294"><span class="php-comment">     *
</span></span><span class="l" id="line-295"><span class="php-comment">     * @param string $image_file
</span></span><span class="l" id="line-296"><span class="php-comment">     * @return bool
</span></span><span class="l" id="line-297"><span class="php-comment">     */</span>
</span><span class="l" id="line-298">    <span class="php-keyword1">private</span> <span
                        class="php-keyword1">function</span> is_transparent_png(<span class="php-var">$image_file</span> = <span
                        class="php-quote">&quot;/tmp/image.png&quot;</span>)
</span><span class="l" id="line-299">    {
</span><span class="l" id="line-300">        <span class="php-keyword1">return</span> <span
                        class="php-keyword2">ord</span>(<span class="php-keyword2">file_get_contents</span>(<span
                        class="php-var">$image_file</span>, <span class="php-keyword1">null</span>, <span
                        class="php-keyword1">null</span>, <span class="php-num">25</span>, <span
                        class="php-num">1</span>)) == <span class="php-num">6</span>;
</span><span class="l" id="line-301">    }
</span><span class="l" id="line-302">
</span><span class="l" id="line-303">    <span class="php-comment">/**
</span></span><span class="l" id="line-304"><span class="php-comment">     * Sets a position from where we should crop the image for the best fit.
</span></span><span class="l" id="line-305"><span class="php-comment">     * It is only for customized position cropping purpose.
</span></span><span class="l" id="line-306"><span class="php-comment">     * Optional to call.
</span></span><span class="l" id="line-307"><span class="php-comment">     * Defaults to center in horizontal and vertical positions.
</span></span><span class="l" id="line-308"><span class="php-comment">     *
</span></span><span class="l" id="line-309"><span class="php-comment">     * @param int $position_id
</span></span><span class="l" id="line-310"><span class="php-comment">     */</span>
</span><span class="l" id="line-311">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> set_postion(<span
                        class="php-var">$position_id</span> = <span class="php-num">0</span>)
</span><span class="l" id="line-312">    {
</span><span class="l" id="line-313">        <span class="php-var">$position_id</span> = (int)<span class="php-var">$position_id</span>;
</span><span class="l" id="line-314">        <span class="php-var">$this</span>-&gt;position_id = <span class="php-var">$position_id</span>;
</span><span class="l" id="line-315">    }
</span><span class="l" id="line-316">
</span><span class="l" id="line-317">    <span class="php-comment">/**
</span></span><span class="l" id="line-318"><span class="php-comment">     * Hack against the position IDs.
</span></span><span class="l" id="line-319"><span class="php-comment">     * Rather use these hard coded values.
</span></span><span class="l" id="line-320"><span class="php-comment">     *
</span></span><span class="l" id="line-321"><span class="php-comment">     * @param int $x
</span></span><span class="l" id="line-322"><span class="php-comment">     * @param int $y
</span></span><span class="l" id="line-323"><span class="php-comment">     */</span>
</span><span class="l" id="line-324">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> set_xy(<span class="php-var">$x</span> = <span
                        class="php-num">0</span>, <span class="php-var">$y</span> = <span class="php-num">0</span>)
</span><span class="l" id="line-325">    {
</span><span class="l" id="line-326">        <span class="php-var">$this</span>-&gt;cropnail_x = (int)<span
                        class="php-var">$x</span>;
</span><span class="l" id="line-327">        <span class="php-var">$this</span>-&gt;cropnail_y = (int)<span
                        class="php-var">$y</span>;
</span><span class="l" id="line-328">    }
</span><span class="l" id="line-329">
</span><span class="l" id="line-330">    <span class="php-comment">/**
</span></span><span class="l" id="line-331"><span class="php-comment">     * Print the debug message
</span></span><span class="l" id="line-332"><span class="php-comment">     * @todo Remove this
</span></span><span class="l" id="line-333"><span class="php-comment">     */</span>
</span><span class="l" id="line-334">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> debug()
</span><span class="l" id="line-335">    {
</span><span class="l" id="line-336">        <span class="php-keyword1">echo</span> <span
                        class="php-keyword2">implode</span>(<span class="php-quote">&quot;\r\n&quot;</span>, <span
                        class="php-var">$this</span>-&gt;debug);
</span><span class="l" id="line-337">    }
</span><span class="l" id="line-338">
</span><span class="l" id="line-339">    <span class="php-comment">/**
</span></span><span class="l" id="line-340"><span class="php-comment">     * Retrieve x1, y1, x2, y2
</span></span><span class="l" id="line-341"><span class="php-comment">     * @todo If unused, remove.
</span></span><span class="l" id="line-342"><span class="php-comment">     *
</span></span><span class="l" id="line-343"><span class="php-comment">     * @return string (x1,y1), (x2,y2)
</span></span><span class="l" id="line-344"><span class="php-comment">     */</span>
</span><span class="l" id="line-345">    <span class="php-keyword1">public</span> <span
                        class="php-keyword1">function</span> x1y1x2y2()
</span><span class="l" id="line-346">    {
</span><span class="l" id="line-347">        <span class="php-keyword1">return</span> <span
                        class="php-quote">&quot;(</span><span class="php-var">{$this-&gt;source_x1}</span><span
                        class="php-quote">,</span><span class="php-var">{$this-&gt;source_y1}</span><span
                        class="php-quote">), (</span><span class="php-var">{$this-&gt;source_x2}</span><span
                        class="php-quote">,</span><span class="php-var">{$this-&gt;source_y2}</span><span
                        class="php-quote">)&quot;</span>;
</span><span class="l" id="line-348">    }
</span><span class="l" id="line-349">}
</span><span class="l" id="line-350"></span><br></code></pre>
            </div>
            <div id="footer">
                Generated by <a href="https://github.com/apigen/apigen">ApiGen</a>
            </div>
        </div>
    </div>
</div>

<script src="resources/jquery-3.2.1.min.js"></script>
<script src="resources/jquery-ui-1.12.1.min.js"></script>

<script src="elementlist.js"></script>
<script src="resources/main.js"></script>
</body>
</html>


